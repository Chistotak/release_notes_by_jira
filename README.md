# Генератор Release Notes из JIRA (SC-ReleaseNotesGen)

Этот скрипт предназначен для автоматического формирования Release Notes на основе задач из JIRA. Он извлекает данные по указанному ID фильтра JIRA, обрабатывает их в соответствии с гибкими правилами конфигурации и генерирует документ Release Notes в формате Markdown, а также имеет базовую поддержку для .docx (Word).

## Основные возможности

*   **Получение данных из JIRA**: Использует ID существующего фильтра JIRA для выборки задач. Аутентификация происходит через Cookie. Реализована пагинация для обработки большого количества задач.
*   **Гибкая конфигурация**: Все ключевые аспекты настраиваются через `config/config.yaml`. Подробности см. в [CONFIGURATION_DETAILS.md](CONFIGURATION_DETAILS.md).
    *   Параметры JIRA (URL, таймауты, запрашиваемые поля, включая `issuelinks` и кастомные поля).
    *   Правила парсинга глобальной версии и версий микросервисов.
    *   Структура Release Notes: заголовок, таблица микросервисов, настраиваемые секции.
    *   **Отображение задач**: Для каждой секции можно задать многострочный шаблон, по которому будет отображаться информация о задаче, используя плейсхолдеры для различных полей JIRA.
    *   **Фильтрация связанных задач**: Возможность отображать только те связанные задачи (`issuelinks`), которые относятся к определенным проектам (по префиксу ключа задачи).
    *   **Условное отображение информации о клиенте**: Информация о клиенте (из кастомного поля) отображается только если для задачи есть отфильтрованные (релевантные) связанные задачи.
    *   **Режимы группировки**:
        *   Группировка задач по микросервисам и (опционально) по типам задач.
        *   Возможность отключить всю группировку для секции и выводить задачи "плоским" списком.
*   **Параметры по умолчанию**: Возможность указать ID фильтра и директорию вывода по умолчанию в `config.yaml`.
*   **Интерактивный режим**: Если основные параметры (ID фильтра, директория вывода, JIRA Cookie) не заданы, скрипт запросит их у пользователя.
*   **Вывод в Markdown и Word**:
    *   Генерация и сохранение Release Notes в файл формата Markdown.
    *   Базовая генерация и сохранение Release Notes в файл формата Word (.docx), с возможностью использования шаблона Word.
*   **Логирование**: Ведение логов работы скрипта с настраиваемым уровнем детализации.

## Установка

1.  **Клонируйте репозиторий или скопируйте файлы проекта.**
2.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python -m venv .venv 
    # Windows: .venv\Scripts\activate 
    # macOS/Linux: source .venv/bin/activate
    ```
3.  **Установите зависимости:**
    Создайте файл `requirements.txt`:
    ```txt
    PyYAML>=6.0
    python-dotenv>=1.0.0
    requests>=2.25.0
    python-docx>=1.1.0 
    ```
    И выполните:
    ```bash
    pip install -r requirements.txt
    ```

## Конфигурация

Основная настройка осуществляется через:
1.  **`.env`**: Для хранения `JIRA_COOKIE_STRING`.
2.  **`config/config.yaml`**: Для всех остальных настроек.

**Подробное описание всех параметров конфигурации см. в файле [CONFIGURATION_DETAILS.md](CONFIGURATION_DETAILS.md).**

## Запуск скрипта

1.  Убедитесь, что вы находитесь в корневой директории проекта и виртуальное окружение активировано.
2.  Убедитесь, что файлы `.env` и `config/config.yaml` настроены корректно.
3.  Выполните команду:

    ```bash
    python src/core_logic.py [ID_ФИЛЬТРА_JIRA] [опции]
    ```

    **Аргументы и опции:**
    *   `[ID_ФИЛЬТРА_JIRA]` (опциональный): ID фильтра JIRA.
        *   **Приоритет:** 1. CLI > 2. `config.yaml` (`defaults.filter_id`) > 3. Интерактивный запрос.
    *   `--output-dir <ПУТЬ>` (опциональный): Директория для сохранения файлов.
        *   **Приоритет:** 1. CLI > 2. `config.yaml` (`defaults.output_dir`) > 3. Интерактивный запрос (дефолт `./`).
    *   `--loglevel <УРОВЕНЬ>` (опциональный): Уровень логов (`debug`, `info`, `warning`, `error`, `critical`). По умолчанию: `info`.

    **Примеры:**
    ```bash
    python src/core_logic.py 12345
    python src/core_logic.py
    python src/core_logic.py 67890 --output-dir releases_archive --loglevel debug
    ```

## Структура проекта
release-notes-generator/
|
├───.venv/
├───config/
│ ├───config.yaml
│ └───templates/
│ └───rn_template.docx
  └───CONFIGURATION_DETAILS.md
├───src/
│ ├───__init__.py
│ ├───main.py
│ ├───config_loader.py
│ ├───jira_client.py
│ ├───data_processor.py
│ ├───markdown_generator.py
│ └───word_generator.py
├───.env
├───.gitignore
├───README.md
└───requirements.txt