# Генератор Release Notes из JIRA (SC-ReleaseNotesGen)

Этот скрипт предназначен для автоматического формирования Release Notes на основе задач из JIRA. Он извлекает данные по указанному ID фильтра JIRA, обрабатывает их в соответствии с гибкими правилами конфигурации и генерирует документ Release Notes в формате Markdown.

## Основные возможности

*   **Получение данных из JIRA**: Использует ID существующего фильтра JIRA для выборки задач. Аутентификация происходит через Cookie. Реализована пагинация для обработки большого количества задач.
*   **Гибкая конфигурация**: Все ключевые аспекты настраиваются через `config/config.yaml`. Подробности см. в [CONFIGURATION_DETAILS.md](CONFIGURATION_DETAILS.md).
    *   Параметры JIRA (URL, таймауты, запрашиваемые поля, включая `issuelinks`).
    *   Правила парсинга глобальной версии и версий микросервисов.
    *   Структура Release Notes: заголовок, таблица микросервисов, настраиваемые секции.
    *   **Отображение задач**: Для каждой секции можно задать многострочный шаблон, по которому будет отображаться информация о задаче, используя плейсхолдеры для различных полей JIRA. Реализовано условное отображение блоков (например, "Связанные задачи:" появляется только если связи есть).
    *   **Режимы группировки**:
        *   Группировка задач по микросервисам и (опционально) по типам задач.
        *   Возможность отключить всю группировку для секции и выводить задачи "плоским" списком.
*   **Параметры по умолчанию**: Возможность указать ID фильтра и директорию вывода по умолчанию в `config.yaml`.
*   **Интерактивный режим**: Если основные параметры (ID фильтра, директория вывода, JIRA Cookie) не заданы через командную строку или файл конфигурации, скрипт запросит их у пользователя (ввод Cookie скрыт).
*   **Вывод в Markdown**: Генерация и сохранение Release Notes в файл формата Markdown с настраиваемым именем.
*   **Логирование**: Ведение логов работы скрипта с настраиваемым уровнем детализации (`debug`, `info`, `warning`, `error`, `critical`).

## Установка

1.  **Клонируйте репозиторий или скопируйте файлы проекта.**
2.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python -m venv .venv 
    # Windows: .venv\Scripts\activate 
    # macOS/Linux: source .venv/bin/activate
    ```
3.  **Установите зависимости:**
    Создайте файл `requirements.txt` со следующим содержимым:
    ```txt
    PyYAML>=6.0
    python-dotenv>=1.0.0
    requests>=2.25.0
    ```
    Затем выполните:
    ```bash
    pip install -r requirements.txt
    ```

## Конфигурация

Основная настройка осуществляется через:
1.  **`.env`**: Для хранения `JIRA_COOKIE_STRING`.
2.  **`config/config.yaml`**: Для всех остальных настроек, включая параметры по умолчанию для запуска и шаблоны отображения.

**Подробное описание всех параметров конфигурации см. в файле [CONFIGURATION_DETAILS.md](CONFIGURATION_DETAILS.md).**

## Запуск скрипта

1.  Убедитесь, что вы находитесь в корневой директории проекта и виртуальное окружение активировано.
2.  Убедитесь, что файлы `.env` и `config/config.yaml` настроены корректно (особенно `JIRA_COOKIE_STRING` и `jira.server_url`).
3.  Выполните команду:

    ```bash
    python src/main.py [ID_ФИЛЬТРА_JIRA] [опции]
    ```

    **Аргументы и опции:**
    *   `[ID_ФИЛЬТРА_JIRA]` (опциональный): ID существующего фильтра в JIRA.
        *   **Приоритет определения:** 1. Значение из командной строки. 2. Значение из `config.yaml` (секция `defaults.filter_id`). 3. Интерактивный запрос у пользователя.
    *   `--output-dir <ПУТЬ_К_ПАПКЕ>` (опциональный): Директория для сохранения сгенерированного Markdown файла.
        *   **Приоритет определения:** 1. Значение из командной строки. 2. Значение из `config.yaml` (секция `defaults.output_dir`). 3. Интерактивный запрос (по умолчанию будет предложена текущая директория `./`).
    *   `--loglevel <УРОВЕНЬ>` (опциональный): Уровень детализации логов. Возможные значения: `debug`, `info`, `warning`, `error`, `critical`. По умолчанию: `info`.

    **Примеры запуска:**
    ```bash
    # Запуск с ID фильтра 12345, остальные параметры из конфига или интерактивно
    python src/main.py 12345

    # Запуск с использованием параметров по умолчанию из config.yaml (если они там заданы)
    # или полностью интерактивный запрос, если в CLI и конфиге ничего нет
    python src/main.py

    # Запуск с явным указанием ID фильтра, директории вывода и уровня логов DEBUG
    python src/main.py 67890 --output-dir generated_notes --loglevel debug
    ```

## Структура проекта
release-notes-generator/
|
├───.venv/ # Виртуальное окружение
├───config/
│ └───config.yaml # Основной файл конфигурации
├───src/ # Исходный код
│ ├───__init__.py
│ ├───main.py # Главный исполняемый файл
│ ├───config_loader.py # Загрузчик конфигурации
│ ├───jira_client.py # Клиент для JIRA API
│ ├───data_processor.py # Обработчик данных из JIRA
│ └───markdown_generator.py # Генератор Markdown
├───.env # Для JIRA_COOKIE_STRING
├───.gitignore # Файл исключений для Git
├───README.md # Этот файл
├───CONFIGURATION_DETAILS.md # Подробное описание конфигурации
└───requirements.txt # Зависимости Python